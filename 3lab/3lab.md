# Лабораторная работа №3: Разработка асинхронного API с WebSocket и Celery

В данной лабораторной работе вам предстоит расширить функциональность ваших проектов, созданных в первой лабораторной работе. Вы будете интегрировать технологию WebSocket для обеспечения двусторонней связи в режиме реального времени, а также использовать Celery для выполнения длительных задач в фоновом режиме с отправкой уведомлений через WebSocket.

# Общие требования

Доработать серверную часть для поддержки WebSocket-соединений
Интегрировать Celery для обработки длительных задач
Настроить отправку уведомлений через WebSocket при завершении задач Celery
Разработать консольный клиент для взаимодействия с сервером

# Лабораторная работа №2: Разработка асинхронного API с WebSocket и Celery

В данной лабораторной работе вам предстоит расширить функциональность ваших проектов, созданных в первой лабораторной работе. Вы будете интегрировать технологию WebSocket для обеспечения двусторонней связи в режиме реального времени, а также использовать Celery для выполнения длительных задач в фоновом режиме с отправкой уведомлений через WebSocket.

## Общие требования

- Доработать серверную часть для поддержки WebSocket-соединений
- Интегрировать Celery для обработки длительных задач
- Настроить отправку уведомлений через WebSocket при завершении задач Celery
- Разработать консольный клиент для взаимодействия с сервером
- Сохранить функциональность REST API из предыдущей лабораторной работы

## Использованать redislite вместо Redis!

## Структура проекта

project/
├── app/
│   ├── api/           # эндпоинты
│   ├── core/          # config
│   ├── db/            # файл базы данных и сессия подключения
│   ├── models/        # модели для базы данных
│   ├── cruds/         # ORM CRUD операции
│   ├── schemas/       # схемы запросов
│   ├── services/      # доп. сервисы и логика
│   ├── celery/        # настройки и задачи Celery
│   └── websocket/     # модули для работы с WebSocket
├── main.py
├── alembic/
└── .env

## Требования к WebSocket

1. Создать эндпоинты для подключения через WebSocket
2. Организовать уведомления о ходе выполнения длительных задач
3. Реализовать отправку окончательных результатов по завершении задач

## Требования к Celery

1. Настроить Celery с использованием redislite в качестве брокера и бэкенда
2. Создать задачи для выполнения длительных операций
3. Организовать обновление статуса выполнения задач
4. Настроить отправку уведомлений через WebSocket

## Требования к консольному клиенту

1. Реализовать интерактивный режим с приглашением к вводу команд
2. Добавить поддержку выполнения скрипта из файла
3. Реализовать подключение к WebSocket и обработку сообщений
4. Разработать механизм аутентификации и передачи токена

## Вариант 5. Брутфорс - WebSocket оповещения

Для каждого пользователя должен быть создан отдельный канал WebSocket, который будет отправлять клиенту следующие уведомления:

1. Начало процесса:

json

```
{
  "status": "STARTED",
  "task_id": "unique-task-id",
  "hash_type": "rar",
  "charset_length": 62,
  "max_length": 8
}
```

2. Прогресс перебора:

json

```
{
  "status": "PROGRESS",
  "task_id": "unique-task-id",
  "progress": 30,
  "current_combination": "abc",
  "combinations_per_second": 15000
}
```

3. Завершение процесса:

json

```
{
  "status": "COMPLETED",
  "task_id": "unique-task-id",
  "result": "найденный_пароль",
  "elapsed_time": "00:05:23"
}
```

При запуске нескольких брутфорс-задач сервер должен обрабатывать каждую задачу параллельно и отправлять уведомления с соответствующим  ``task_id``. Клиент должен уметь управлять несколькими задачами одновременно (приостанавливать, возобновлять или отменять выполнение).
