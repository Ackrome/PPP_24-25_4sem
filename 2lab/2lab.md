# Лабораторные работы по программированию: структура и реализация

## Темы лабораторных работ

5. Брутфорс (метод перебора)

## Этапы реализации каждой лабораторной работы

* Базовая реализация с использованием HTTP-протоколов (GET, POST)

* Интеграция веб-сокетов для real-time взаимодействия

* Внедрение Redis и Celery для асинхронного выполнения задач

## Общие требования к проектам

- Использование FastAPI в качестве веб-фреймворка
- SQLite как база данных
- SQLAlchemy для ORM (Object-Relational Mapping)
- Реализация авторизации по email и паролю
- Аутентификация с использованием JWT (JSON Web Tokens)

## Структура проекта

project/`<br>`
├── app/`<br>`
│   ├── api/           # эндпоинты `<br>`
│   ├── core/          # config `<br>`
│   ├── db/            # файл базы данных и сессия подключения `<br>`
│   ├── models/        # модели для базы данных `<br>`
│   ├── cruds/         # ORM CRUD операции `<br>`
│   ├── schemas/       # схемы запросов `<br>`
│   └── services/      # доп. сервисы, в нашем случае тут будет лежать логика
├── main.py `<br>`
├── alembic/`<br>`
└── .env `<br>`

## Базовые эндпоинты

### Регистрация нового пользователя

@router.post("/sign-up/")
Проверяет, не зарегистрирован ли уже пользователь с таким email.
Если нет, создает нового пользователя и генерирует для него токен.
Возвращает данные созданного пользователя.

Пример запроса:`<br>`
{`<br>`
"email": "user@example.com",`<br>`
"password": "securepassword123"`<br>`
}`<br>`
Пример ответа:`<br>`
{`<br>`
"id": 1,`<br>`
"email": "user@example.com",`<br>`
"token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."`<br>`
}

### Вход в систему

@router.post("/login/")
Проверяет существование пользователя с указанным email.
Проверяет правильность введенного пароля.
Если все верно, генерирует новый токен для пользователя.
Возвращает данные пользователя с новым токеном.

Пример запроса:`<br>`
{`<br>`
"email": "user@example.com",`<br>`
"password": "securepassword123"`<br>`
}`<br>`
Пример ответа:`<br>`
{`<br>`
"id": 1,`<br>`
"email": "user@example.com",`<br>`
"token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."`<br>`
}

### Получение информации о текущем пользователе

@router.get("/users/me/")
Возвращает данные авторизованного пользователя.

Пример ответа:`<br>`
{`<br>`
"id": 1,`<br>`
"email": "user@example.com"`<br>`
}

Данные о пользователе должны сохраняться в базу данных для чего вам надо написать CRUD'ы.
Необходимо пользоваться alembic для миграции базы данных.

## Вариант 5. Брутфорс (Этап 1)

Полный перебор (или метод «грубой силы», англ. brute force) — метод решения математических задач. Относится к классу методов поиска решения исчерпыванием всевозможных вариантов[англ.]. Сложность полного перебора зависит от количества всех возможных решений задачи. Если пространство решений очень велико, то полный перебор может не дать результатов в течение нескольких лет или даже столетий.`<br>`
[К ознакомлению](https://habr.com/ru/companies/otus/articles/846872/)

Для начала попробуем разработать алгорим брутфорса
своими средствами.
Ломать будем пароленный rar-архив.

Алгоритм будет состоять из нескольких этапов.

1) Извлечения хеша из RAR-архива (можно использовать сторонние библиотеки, к примеру rar2john из набора John the Ripper)
2) Определяемся со словарем из символов, которые потенциально могут быть в пароле, а также с его максимальной длиной.
3) Сгенерировать все возможные пароли и занести их в файл.
4) Осуществить эффективную брутфорс атаку на хеш архива.

### Эндпоинты:

@app.post("/brut_hash")`<br>`
Принимает хеш, словарь, максимальное количество символов (с ограничением в 8) и возвращает id задачи.

{`<br>`
  "hash": "строка с хешем RAR-архива",`<br>`
  "charset": "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",`<br>`
  "max_length": 8 `<br>`
}

Возвращает:`<br>`
{`<br>`
  "task_id": "уникальный идентификатор задачи"`<br>`
}

@app.get("/get_status")`<br>`
Принимает id и возвращает статус задачи.`<br>`
Возвращает:`<br>`
{`<br>`
  "status": "running/completed/failed",`<br>`
  "progress": 45,`<br>`
  "result": "найденный пароль или null"`<br>`
}
